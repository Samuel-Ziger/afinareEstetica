rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // Regras para agendamentos - qualquer um pode criar, apenas autenticados podem ler
    match /agendamentos/{agendamentoId} {
      allow create: if request.auth != null || request.auth == null; // Permite criação sem autenticação
      allow read, update, delete: if request.auth != null; // Apenas autenticados podem ler/atualizar/deletar
    }
    
    // Regras para agendamentos fixos - apenas autenticados podem ler e escrever
    match /agendamentos-fixos/{recurringId} {
      allow read, write: if request.auth != null; // Apenas autenticados podem acessar
    }
    
    // Regras para serviços - apenas autenticados podem ler e escrever
    match /servicos/{servicoId} {
      allow read: if request.auth != null || request.auth == null; // Permite leitura pública
      allow create, update, delete: if request.auth != null; // Apenas autenticados podem escrever
    }
    
    // Regras para combos - apenas autenticados podem ler e escrever
    match /combos/{comboId} {
      allow read: if request.auth != null || request.auth == null; // Permite leitura pública
      allow create, update, delete: if request.auth != null; // Apenas autenticados podem escrever
    }
    
    // Regras para cursos - apenas autenticados podem ler e escrever
    match /cursos/{cursoId} {
      allow read: if request.auth != null || request.auth == null; // Permite leitura pública
      allow create, update, delete: if request.auth != null; // Apenas autenticados podem escrever
    }
    
    // Regras para configurações - apenas autenticados podem ler e escrever
    match /config/{configId} {
      allow read: if request.auth != null || request.auth == null; // Permite leitura pública
      allow create, update, delete: if request.auth != null; // Apenas autenticados podem escrever
    }
    
    // Regras para usuários - apenas o próprio usuário pode ler/escrever
    match /users/{userId} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }
  }
}
